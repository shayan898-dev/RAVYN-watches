<!DOCTYPE html>
<html lang="en">
<head>
  <title>RAVYN Watches - Product Detail</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="stylesheet" href="./Styles/header-footer.css">
  <link rel="stylesheet" href="./css/all.min.css">
  <link rel="stylesheet" href="./css/fontawesome.min.css">
  <link rel="stylesheet" href="./Styles/responsive.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <style>
    /* --- Global Reset & Body --- */
    * {
        box-sizing: border-box; /* Ensures padding doesn't break layout */
      }
      
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        padding: 0;
        margin: 0;
        width: 100%;
        background-color: rgb(240, 240, 240);
      }

      /* --- Main Product Container --- */
      .prodetails {
        width: 100%;
        display: flex;
        padding: 40px 60px  ;
        background-color: #fff;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      }

      /* --- Left Side: Images --- */
      .single-pro-image {
        width: 40%;
        margin-right: 50px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
      }

      .main-img {
        width: 100%;
        border-radius: 10px;
        margin-bottom: 10px;
        object-fit: cover;
        border: 1px solid #ddd;
      }

      /* Gallery Grid */
      .small-img-group {
        display: flex;
        justify-content: center;
        flex-wrap: wrap; /* Allows multiple rows of images */
        gap: 10px; /* Space between thumbnails */
        width: 100%;
      }

      .small-img-col {
        flex-basis: 15%; /* Fits ~4 images per row */
        cursor: pointer;
      }

      .small-img-col img {
        width: 100%;
        height: auto;
        border-radius: 5px;
        border: 1px solid #ccc;
        transition: transform 0.2s ease;
      }

      .small-img-col img:hover {
        transform: scale(1.05);
        border-color: black;
      }

      /* --- Right Side: Details --- */
      .single-pro-details {
        width: 50%;
        padding-top: 0px;
      }

      .single-pro-details h6 {
        font-size: 14px;
        color: #555;
        margin: 0 0 20px 0;
      }

      .pro-name {
        font-size: 28px;
        margin-bottom: 15px;
        font-weight: 700;
        color: #1a1a1a;
      }

      .pro-price {
        font-size: 26px;
        font-weight: bold;
        color: red; /* Theme color */
        margin-bottom: 20px;
      }
      /* --- Add these to your existing CSS --- */
      .old-price {
          text-decoration: line-through;
          color: gray;
          font-size: 0.7em; /* Makes it smaller than the main price */
          margin-right: 15px;
          font-weight: normal;
      }

      .new-price {
          color: red; /* Highlights the discounted price */
      }

      .discount-badge {
          font-size: 0.5em;
          background-color: black;
          color: white;
          padding: 4px 10px;
          border-radius: 5px;
          vertical-align: middle;
          margin-left: 10px;
          font-weight: normal;
          letter-spacing: 1px;
      }
      .button-container{
        display: flex;
        width: 100%;
      }
      .quantity-container {
        display: flex;
        align-items: center;
        border: 1.5px solid #000; /* Made slightly thicker to match your theme */
        border-radius: 50px;       /* This creates the "Pill" shape */
        width: 130px; 
        margin-bottom: 20px;
        overflow: hidden;         /* Keeps the button backgrounds inside the rounded border */
        background-color: #fff;
        margin-right: 15px;
      }

      /* The Input Field (Center) */
      .quantity-input {
        width: 40px;
        text-align: center;
        border: none;
        font-size: 18px;
        font-weight: bold;
        outline: none;
        background: transparent;
        pointer-events: none;
      }

      /* The Buttons (+ and -) */
      .qty-btn {
        flex: 1;
        background-color: transparent; /* Changed to transparent for a cleaner look */
        border: none;
        height: 40px;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s ease;
        color: #000;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-right: 10px;
      }

      /* Hover effect for buttons */
      .qty-btn:hover {
        background-color: #f0f0f0;
      }

      .qty-btn:active {
        background-color: #e0e0e0;
      }

      /* Buttons */
      .add-cart-btn { 
        background: #fff;
        color: black;
        padding: 11px 30px;
        border: 1px solid black;
        cursor: pointer;
        font-weight: bold;
        border-radius: 25px;
        font-size: 16px;
        transition: 0.3s;
        letter-spacing: 1px;
        margin-top: 0px;
        margin-right: 10px;
        margin-left: 0px;
        margin-bottom: 20px; /* Adds space if they stack */
      }

      .buy-now-btn {
        background: black;
        color: #fff;
        padding: 14px 30px;
        border: 2px solid black;
        cursor: pointer;
        border-radius: 25px;
        font-size: 16px;
        transition: 0.3s;
        margin-bottom: 10px;
        width: 49%;
        letter-spacing: 1px;
      }

      .single-pro-details h4 {
        margin-top: 30px;
        margin-bottom: 10px;
        font-size: 20px;
      }

      .pro-desc {
        line-height: 1.6;
        color: #555;
        font-size: 16px;
        display: block;
      }
      .delivery-status-widget {
        display: flex;
        flex-direction: row;
        justify-content: space-around;
        align-items: center;
        font-size: 16px;
        margin-bottom: 10px;
        margin-top: 50px;
        line-height: 15px;
        color: #000000;
        border: 1px solid black;
        border-radius: 6px;
        padding: 15px 0px;
      }
      .status-text{
        font-weight: bold;
        margin:5px 0px;
      }
      .status{
        text-align: center;
      }
      .t4s-table-res-df {
        min-height: .01%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
        -ms-overflow-style: -ms-autohiding-scrollbar;
      }
      .comparision-table-container{
        background-color: white;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        margin-top: 0px;
      }
      .comparision-table-container h3{
        font-size: 26px;
        margin-bottom: 0px;
      }
      .comparision-table-container p{
        font-size: 20px;
        margin-top: 10px;

      }
      .comparison-table {
        width: auto;
        max-width: 700px;
        margin: 10px auto;
        border-collapse: collapse;
        border: 2px solid #000;
      }
      .main{
        background-color: black;
        color: white;
        padding: 10px 60px;
        font-size: 18px;
      }
      .feature-name{
        font-size: 24px;
        font-family: sans-serif;
        border: 1px solid gray;
        padding: 10px 30px;
        text-align: center;
      }
      .check,.cross{
        font-size: 24px;
      }
      /* =========================================
        RESPONSIVE DESIGN (TABLET & MOBILE) 
        ========================================= */
      
      /* Tablet & Mobile Devices */
      @media (max-width: 820px) {
        .prodetails {
          display: flex;
          flex-direction: column; /* Stack vertically */
          width: 100%; /* Prevent it from touching edges */
        }

        .single-pro-image {
          width: 100%;
          margin-right: 0px; /* CLEAR the desktop margin */
          margin-bottom: 30px;
          
          /* NEW: Force content to center */
          display: flex;
          flex-direction: column;
          align-items: center; 
        }

        .main-img {
          width: 100%;
          max-width: 500px; /* Prevent it from getting too huge on tablets */
          object-fit: contain; /* Ensures the whole watch is visible */
        }
        
        /* Center the Gallery Thumbnails too */
        .small-img-group {
          justify-content: center;
        }

        .single-pro-details {
          width: 100%;
        }
        .button-container{
          display: flex;
          flex-direction: column;
          width: 100%;
        }
        .add-cart-btn { 
         width: 44%;
        }
        .buy-now-btn {
          width: 47%;
        }
        .comparision-table-container{
          width: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
          flex-direction: column;
        }
        .comparision-table-container h3{
          font-size: 18px;
          margin-bottom: 0px;
        }
        .comparision-table-container p{
          font-size: 18px;
          margin-top: 10px;
        }
        .comparison-table {
          border: 1px solid #000;
        }
        .main{
          padding: 10px 20px;
          font-size: 15px;
        }
        .feature-name{
          font-size: 16px;
        }
        .check,.cross{
          font-size: 16px;
        }
      }

      /* Extra Small Mobile Devices */
      @media (max-width: 480px) {
        .prodetails {
          padding: 20px;
          width: 100%;
        }
        
        .pro-name { font-size: 22px; }
        .pro-price { font-size: 20px; }

        .add-cart-btn, .buy-now-btn {
          width: 100%;
          display: block; 
          text-align: center;
        }

        .small-img-col {
          flex-basis: 15%; 
        }
        .comparision-table-container{
          width: 100%;
          display: flex;
          justify-content: center;
          align-items: center;
          flex-direction: column;
        }
        .comparision-table-container h3{
          font-size: 18px;
          margin-bottom: 0px;
        }
        .comparision-table-container p{
          font-size: 18px;
          margin-top: 10px;
        }
        .comparison-table {
          border: 1px solid #000;
        }
        .main{
          padding: 10px 20px;
          font-size: 15px;
        }
        .feature-name{
          font-size: 16px;
        }
        .check,.cross{
          font-size: 16px;
        }
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="logo-container">
      <a href="index.html"><h1>RAVYN</h1></a>
    </div>
    
    <div class="header-right-section">
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Search watches..." autocomplete="off">
            <button id="searchBtn"><i class="fa-solid fa-magnifying-glass"></i></button>
            <div class="search-suggestions" id="searchSuggestions"></div>
        </div>

        <a href="index.html"><p class="menu">Home</p></a>
        <a href="collection.html"><p class="menu">Collection</p></a>
        <a href="cart.html"><i class="fa-solid fa-cart-shopping cart-button"><span>0</span></i></a>
        <i class="fa fa-window-close" id="close" aria-hidden="true"></i>
    </div>

    <div class="mobile">
      <i id="bar" class="fas fa-outdent"></i>
    </div>    
  </header>

  <section class="prodetails">
    <div class="single-pro-image">
        <img src="" width="100%" class="main-img" id="MainImg" alt="Product Image">
        
        <div class="small-img-group" id="gallery-container">
          </div>
    </div>
    
    <div class="single-pro-details">
      <h6>Home / Watches</h6>
      
      <h4 class="pro-name">Loading...</h4>
      <h2 class="pro-price">Loading...</h2>
      <div class="properties">
        <p>üöö Free Delivery Across Pakistan</p>

        <p>üéÅ Free RAVYN STORE Premium Packing</p>

        <p>‚úÖ 100% Authentic Guaranteed!</p>
      </div>
      <div class="button-container">
        <div class="quantity-container">
          <button class="qty-btn" id="qty-minus"><i class="fa-solid fa-minus"></i></button>
          <input type="text" class="quantity-input" id="qty-input" value="1" readonly>
          <button class="qty-btn" id="qty-plus"><i class="fa-solid fa-plus"></i></button>
        </div>
        <button class="add-cart-btn">Add To Cart</button>
      </div>
      <button class="buy-now-btn buy-btn">Buy Now</button>
      
      <h4>Product Details</h4>
      <span class="pro-desc">Loading...</span>
      <div class="delivery-status-widget">
        <div class="status">
            <i class="fas fa-shopping-bag status-icon" style="color: #121212;"></i>
            <div class="status-text">Ordered</div>
            <div class="status-date" id="order-date">Feb 7</div>
        </div>
        <div class="status">
            <i class="fas fa-angle-double-right"></i>
        </div>
        <div class="status">
            <i class="fas fa-solid fa-plane status-icon" style="color: #121212;"></i>
            <div class="status-text">Shipped</div>
            <div class="status-date" id="ship-date">Feb 8</div>
        </div>
        <div class="status">
            <i class="fas fa-angle-double-right"></i>
        </div>
        <div class="status">
            <i class="fas fa-box-open status-icon" style="color: #121212;"></i>
            <div class="status-text">Delivered</div>
            <div class="status-date" id="delivery-date">Feb 11</div>
        </div>
    </div>
    </div>
  </section>

  <section class="comparision-table-container">
    <h3>Why People Choose RAVYN Store Watches</h3>
    <p>RAVYN Store VS Others</p>
    <div class="t4s-table-res-df">
      <table class="comparison-table">
        <thead class="table-top">
          <tr>
            <th class="main">Feature</th>
            <th class="main">RAVYN Store</th>
            <th class="main">Others</th>
          </tr>
        </thead>
        <tbody class="table-bottom">
          <tr>
            <td class="feature-name">High quality</td>
            <td class="feature-name"><span class="check">‚úì</span></td>
            <td class="feature-name"><span class="cross">‚úó</span></td>
          </tr>
          <tr>
            <td class="feature-name">Scratch resistant</td>
            <td class="feature-name"><span class="check">‚úì</span></td>
            <td class="feature-name"><span class="cross">‚úó</span></td>
          </tr>
          <tr>
            <td class="feature-name">Luxury design</td>
            <td class="feature-name"><span class="check">‚úì</span></td>
            <td class="feature-name"><span class="cross">‚úó</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <footer class="footer">
    <div class="footer-left-section">
        <h1>RAVYN</h1>
        <p class="footer-text">RAVYN Watches brings premium timepieces crafted for elegance, precision, and everyday style.</p>
    </div>
    <div class="footer-right-section">
      <h2>Social</h2>
      <div class="social-link">
        <p><strong>Address: <br></strong> Sargodha , Pakistan</p>
        <p><strong>Phone: <br></strong> +92-399-99999</p>
        <p><strong>Email: <br></strong> info@support.com</p>
      </div>
      <div class="social-icon">
        <i class="fa-brands fa-tiktok"></i>
        <i class="fa-brands fa-instagram"></i>
        <i class="fa-brands fa-facebook"></i>
      </div>
    </div>
  </footer>

  <div class="mobile-navbar">
    <a href="index.html" class="mobile-nav-item">
      <i class="fa-solid fa-house"></i>
      <span class="label">Home</span>
    </a>
    <a href="collection.html" class="mobile-nav-item">
      <i class="fa-solid fa-shop"></i>
      <span class="label">Shop</span>
    </a>
    <a href="cart.html" class="mobile-nav-item">
      <i class="fa-solid fa-cart-shopping"></i>
      <span class="label">Cart</span>
    </a>
    
    <a href="checkout.html" class="mobile-nav-item">
      <i class="fa-solid fa-credit-card"></i> <span class="label">Checkout</span>
    </a>
    
    <div class="mobile-nav-item" id="mobileSearchTrigger">
      <i class="fa-solid fa-magnifying-glass"></i>
      <span class="label">Search</span>
    </div>
  </div>
  

  <script src="./Script/data.js"></script>

  <script>
    // --- Mobile Menu Logic ---
    const bar = document.getElementById('bar');
    const nav = document.querySelector('.header-right-section');
    const close = document.getElementById('close');

    if (bar) {
      bar.addEventListener('click', () => nav.classList.add('active'));
    }
    if (close) {
      close.addEventListener('click', () => nav.classList.remove('active'));
    }

    // --- Product Loading Logic ---
    const params = new URLSearchParams(window.location.search);
    const productId = params.get('id');
    const product = products.find(p => p.id === productId);

    if (product) {
      const mainImg = document.getElementById('MainImg');
      
      mainImg.src = product.image; 
      document.querySelector('.pro-name').innerText = product.name;
      document.querySelector('.pro-desc').innerText = product.description || product.des || "No description available.";

      // --- 1. NEW PRICE CALCULATION LOGIC ---
      let finalPrice = product.price; // Default to normal price
      
      // If there is a discount, calculate the new price
      if (product.dis > 0) {
          finalPrice = Math.floor(product.price - (product.price * (product.dis / 100)));
          
          // Inject HTML for Stacked Prices (Old crossed out + New Red)
          document.querySelector('.pro-price').innerHTML = `
            <span class="old-price">Rs ${product.price}</span>
            <span class="new-price">Rs ${finalPrice}/-</span>
            <span class="discount-badge">-${product.dis}%</span>
          `;
      } else {
          // No discount, just show normal price
          document.querySelector('.pro-price').innerText = "Rs " + product.price + "/-";
      }

      // --- B. Render Gallery Images ---
      const galleryContainer = document.getElementById('gallery-container');
      if (product.images && product.images.length > 0) {
          let galleryHTML = '';
          product.images.slice(0, 8).forEach((imgSrc) => {
              galleryHTML += `
                  <div class="small-img-col">
                      <img src="${imgSrc}" onclick="changeMainImage('${imgSrc}')" alt="Variation">
                  </div>
              `;
          });
          galleryContainer.innerHTML = galleryHTML;
      }

      // --- C. Quantity Button Logic ---
      const qtyInput = document.getElementById('qty-input');
      const plusBtn = document.getElementById('qty-plus');
      const minusBtn = document.getElementById('qty-minus');

      if(plusBtn){
        plusBtn.addEventListener('click', () => {
            let val = parseInt(qtyInput.value) || 0;
            qtyInput.value = val + 1;
        });
      }

      if(minusBtn){
        minusBtn.addEventListener('click', () => {
            let val = parseInt(qtyInput.value) || 1;
            if (val > 1) qtyInput.value = val - 1;
        });
      }

      // --- D. Cart & Buy Logic ---
      const addCartBtn = document.querySelector('.add-cart-btn');
      const buyNowBtn = document.querySelector('.buy-now-btn');

      // Helper function to add item to cart
      function addToCart(redirect = false) {
        let cart = JSON.parse(localStorage.getItem('ravyn_cart')) || [];
        const quantity = parseInt(qtyInput.value);

        // 1. Add item to cart
        const existingItem = cart.find(item => item.id === product.id);
        if (existingItem) {
          existingItem.quantity += quantity;
        } else {
          cart.push({
            id: product.id,
            name: product.name,
            price: finalPrice, // Uses the calculated discounted price
            image: product.image,
            quantity: quantity
          });
        }

        // 2. Save to storage
        localStorage.setItem('ravyn_cart', JSON.stringify(cart));
        updateCartCount();

        // 3. Handle redirect or feedback
        if (redirect) {
            window.location.href = 'checkout.html';
        } else {
            // Visual Feedback for "Add to Cart"
            const originalText = addCartBtn.innerText;
            addCartBtn.innerText = "Added!";
            addCartBtn.style.backgroundColor = "black";
            addCartBtn.style.color = "white";
            setTimeout(() => {
                addCartBtn.innerText = originalText;
                addCartBtn.style.backgroundColor = "#fff";
                addCartBtn.style.color = "black";
            }, 1000);
        }
      }

      // EVENT LISTENER: Add to Cart Button
      addCartBtn.addEventListener('click', () => {
        addToCart(false); // False means do NOT redirect
      });

      // EVENT LISTENER: Buy Now Button
      buyNowBtn.addEventListener('click', () => {
        addToCart(true); // True means redirect to checkout
      });

      updateShippingDates();

    } else {
      document.querySelector('.single-pro-details').innerHTML = "<h2>Product Not Found</h2><p><a href='index.html'>Go Home</a></p>";
      document.querySelector('.single-pro-image').style.display = 'none';
    }

    // --- Helper Functions ---
    function changeMainImage(src) {
      document.getElementById('MainImg').src = src;
    }

    function updateCartCount() {
      const cart = JSON.parse(localStorage.getItem('ravyn_cart')) || [];
      const totalCount = cart.reduce((acc, item) => acc + item.quantity, 0);
      const countElement = document.querySelector('.cart-button span');
      if (countElement) {
        countElement.innerText = totalCount;
        countElement.style.display = totalCount > 0 ? 'flex' : 'none'; 
      }
    }

    function updateShippingDates() {
      const now = new Date();
      function formatDate(date) {
        return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
      }

      const orderedDate = new Date(now);
      const shippedDate = new Date(now); shippedDate.setDate(orderedDate.getDate() + 1); 
      const deliveredDate = new Date(now); deliveredDate.setDate(orderedDate.getDate() + 4); 

      const orderedEl = document.getElementById('order-date');
      const shippedEl = document.getElementById('ship-date');
      const deliveredEl = document.getElementById('delivery-date');

      if (orderedEl) orderedEl.innerText = formatDate(orderedDate);
      if (shippedEl) shippedEl.innerText = formatDate(shippedDate);
      if (deliveredEl) deliveredEl.innerText = formatDate(deliveredDate);
    }
    
    updateCartCount(); 


    // --- 1. Mobile Side Search Panel Toggle ---
    const mobileSearchTrigger = document.getElementById('mobileSearchTrigger');
    const sideSearchPanel = document.getElementById('sideSearchPanel');
    const closeSideSearch = document.getElementById('closeSideSearch');

    if (mobileSearchTrigger && sideSearchPanel) {
        mobileSearchTrigger.addEventListener('click', () => {
            sideSearchPanel.classList.add('active'); // Slides the panel in
            // Focus the input field after a short delay for smooth animation
            setTimeout(() => document.getElementById('sideSearchInput').focus(), 300);
        });
    }

    if (closeSideSearch && sideSearchPanel) {
        closeSideSearch.addEventListener('click', () => {
            sideSearchPanel.classList.remove('active'); // Slides the panel out
        });
    }

    // --- 2. Unified Search & Suggestion Helper Function ---
    function setupSearch(inputId, btnId, suggestionsId) {
        const input = document.getElementById(inputId);
        const btn = document.getElementById(btnId);
        const suggestionsBox = document.getElementById(suggestionsId);

        if (!input || !suggestionsBox) return;

        // A. Handle instant suggestions as the user types
        input.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            suggestionsBox.innerHTML = '';

            if (query.length === 0) {
                suggestionsBox.style.display = 'none';
                return;
            }

            // Filter products from your global products array (data.js)
            const matches = products.filter(p => p.name.toLowerCase().includes(query));

            if (matches.length > 0) {
                matches.forEach(product => {
                    const div = document.createElement('div');
                    div.classList.add('suggestion-item');
                    div.innerHTML = `
                        <img src="${product.image}" alt="${product.name}" class="suggestion-img">
                        <div class="suggestion-info">
                            <h4>${product.name}</h4>
                            <p>Rs ${product.price}</p>
                        </div>
                    `;
                    div.addEventListener('click', () => {
                        window.location.href = `Product-detail.html?id=${product.id}`;
                    });
                    suggestionsBox.appendChild(div);
                });
                suggestionsBox.style.display = 'block';
            } else {
                suggestionsBox.style.display = 'none';
            }
        });

        // B. Execute full search redirect on Enter key or Button Click
        const execute = () => {
            const query = input.value.trim();
            if (query) {
                window.location.href = `collection.html?search=${encodeURIComponent(query)}`;
            }
        };

        if (btn) btn.addEventListener('click', execute);
        input.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') execute();
        });

        // C. Close suggestions if clicking outside the search area
        document.addEventListener('click', (e) => {
            if (!input.contains(e.target) && !suggestionsBox.contains(e.target)) {
                suggestionsBox.style.display = 'none';
            }
        });
    }

    // --- 3. Initialize Search for Different UI Elements ---
    // Desktop Search Bar
    setupSearch('searchInput', 'searchBtn', 'searchSuggestions');

    // Mobile Side Panel Search Bar
    setupSearch('sideSearchInput', 'sideSearchBtn', 'sideSearchSuggestions');
  </script>
</body>
</html>